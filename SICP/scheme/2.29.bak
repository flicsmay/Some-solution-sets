#lang planet neil/sicp

; Exercise 2.29

; make-mobile : s_list, s_list (rec)
(define (make-mobile left right)
  (list left right))

; make-branch : int, s_list
(define (make-branch length structure)
  (list length structure))

; left-branch : s_tree(list)
; Selector
(define (left-branch branch)
  (car branch))

; right-branch : s_tree(list)
; Selector
(define (right-branch branch)
  (cadr branch))

; branch-length : s_list
; return the length of given branch
(define (branch-length branch)
  (car branch))

; branch-structure : s_list
; return the structure of given branch
(define (branch-structure branch)
  (cadr branch))

; branch-weigth : s_list
; returun the 

; total-weigth : s_tree
; return the total weigth of a given branch
(define (total-weigth branch)
  (let ((left-is-branch? (is-a-branch? (left-branch branch)))
        (right-is-branch? (is-a-branch? (right-branch branch))))
    (cond (left-is-branch? ; if left is a branch then right must be a branch
           (+ (total-weigth (left-branch branch))
              (total-weigth (right-branch branch))))
          (right-is-branch?
           (total-weigth (right-branch branch)))
          (else
           (branch-structure branch)))))

; is-a-branch : s_list
; return TRUE if the given list is a branch
(define (is-a-branch? branch)
  (pair? branch))